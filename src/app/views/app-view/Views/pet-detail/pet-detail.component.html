<ng-container *ngIf="{ isEditMode: isEditMode$ | async } as vm">
  <div class="pet-detail">
    <div class="pet-detail__header">
      <div class="inline">
        <button mat-button (click)="backClicked()">
          <mat-icon>arrow_back</mat-icon>
        </button>
      </div>
      <div class="inline">
        <app-button variant="raised" (click)="editButtonClick()">
          <mat-icon>edit</mat-icon> {{ "action.edit" | translate }}
        </app-button>

        <app-button variant="raised" (click)="saveEditButtonClick()" [disabled]="vm.isEditMode === false">
          <mat-icon>star</mat-icon> {{ "action.save" | translate }}
        </app-button>
      </div>
    </div>
    <mat-tab-group mat-align-tabs="center" #tabGroup>
      <mat-tab label="Dane przyjętego zwierzęcia" [disabled]="!!vm.isEditMode">
        <div *ngIf="tabGroup.selectedIndex === petStepsEnum.basicData" class="pet-detail_content">
          <ng-container *ngIf="{ isLoading: isLoading$ | async } as vm">
            <app-pet-basic-data #basicDataRef [data]="basicData$ | async" [avatar]="avatar$ | async"
              (updateAvatar)="updateAvatar($event)"
              *ngIf="vm.isLoading === false; else loadingView"></app-pet-basic-data>
            <ng-template #loadingView>
              <app-empty-data [isLoading]="vm.isLoading"></app-empty-data></ng-template>
          </ng-container>
        </div>
      </mat-tab>
      <mat-tab label="Dane wydanego zwierzęcia" [disabled]="!isAdopted || !!vm.isEditMode">
        <div *ngIf="tabGroup.selectedIndex === petStepsEnum.outData" class="pet-detail_content">
          <ng-container *ngIf="{ isLoading: isLoading$ | async } as vm">
            <app-pet-out-data #outDataRef [data]="adoptedData$ | async" [basicData]="basicData$ | async"
              *ngIf="vm.isLoading === false; else loadingView"></app-pet-out-data>
            <ng-template #loadingView>
              <app-empty-data [isLoading]="vm.isLoading"></app-empty-data></ng-template>
          </ng-container>
        </div>
      </mat-tab>
      <mat-tab label="Dokumenty" [disabled]="!!vm.isEditMode">
        <app-file-upload *ngIf="tabGroup.selectedIndex === petStepsEnum.files" [formControl]="attachments">
          {{ "documents.upload" | translate }}
        </app-file-upload>

        <ng-container *ngIf="{ documents: documents$ | async } as vm">
          <ng-container *ngIf="!!vm.documents?.length">
            <ul class="list-attach">
              <app-upload-attachment *ngFor="let file of vm.documents" [file]="file" (remove)="deleteAttachment($event)"
                (showAttachment)="showAttachment($event)"
                (download)="downloadAttachment($event)"></app-upload-attachment>
            </ul>
          </ng-container>
        </ng-container>
      </mat-tab>
    </mat-tab-group>
  </div>
</ng-container>